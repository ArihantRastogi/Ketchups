<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player with Output Settings</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-image: url(ketchups.jpeg);
            background-color: #FBC02D; /* Ketchup color */
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-size: 25%;
        }

        #myVideo {
            display: block;
            margin-bottom: 20px;
        }

        .button-container {
            display: flex;
            margin-bottom: 20px;
        }

        button {
            background-color: #D32F2F; /* Darker red */
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
            margin-right: 10px;
        }

        button:hover {
            background-color: #B71C1C; /* Dark red */
        }

        select {
            padding: 8px;
            border-radius: 5px;
        }
    </style>
</head>
<body>

<video id="myVideo" width="640" height="360" controls>
    <source src="test.mp4" type="video/mp4">
    Your browser does not support the video tag.
</video>

<div class="button-container">
    <button onclick="addBackgroundMusic()">Add Background Music</button>
    <button onclick="selectOutputSettings()">Select Output Settings</button>
</div>

<audio id="backgroundMusic" loop>
    <source src="background_music.mp3" type="audio/mp3">
    Your browser does not support the audio tag.
</audio>

<script>
    function addBackgroundMusic() {
        var video = document.getElementById("myVideo");
        var backgroundMusic = document.getElementById("backgroundMusic");

        if (video.paused) {
            video.play();
            backgroundMusic.play();
        } else {
            video.pause();
            backgroundMusic.pause();
        }
    }

    function selectOutputSettings() {
        var video = document.getElementById("myVideo");

        // Check if dropdown menus already exist and remove them if they do
        var existingDropdowns = document.querySelectorAll(".output-dropdown");
        existingDropdowns.forEach(function(dropdown) {
            dropdown.remove();
        });

        // Create dropdown menus for resolution, quality, image duration, and transition effect
        var resolutionDropdown = createDropdown("resolution", ["640x360", "1280x720", "1920x1080"]);
        var qualityDropdown = createDropdown("quality", ["0.5", "0.8", "1"]);
        var imageDurationDropdown = createDropdown("imageDuration", ["2", "5", "10"]);
        var transitionEffectDropdown = createDropdown("transitionEffect", ["fade", "slide", "none"]);

        // Append dropdown menus to the body
        document.body.appendChild(resolutionDropdown);
        document.body.appendChild(qualityDropdown);
        document.body.appendChild(imageDurationDropdown);
        document.body.appendChild(transitionEffectDropdown);

        // Apply selected settings when a new option is selected
        resolutionDropdown.addEventListener("change", applySettings);
        qualityDropdown.addEventListener("change", applySettings);
        imageDurationDropdown.addEventListener("change", applySettings);
        transitionEffectDropdown.addEventListener("change", applySettings);
    }

    function createDropdown(name, options) {
        var dropdown = document.createElement("select");
        dropdown.classList.add("output-dropdown");
        dropdown.dataset.name = name;
        options.forEach(function(option) {
            var optionElement = document.createElement("option");
            optionElement.value = option;
            optionElement.textContent = option;
            dropdown.appendChild(optionElement);
        });
        return dropdown;
    }

    function applySettings() {
        // Get selected values from dropdown menus
        var resolution = document.querySelector("[data-name='resolution']").value;
        var quality = document.querySelector("[data-name='quality']").value;
        var imageDuration = document.querySelector("[data-name='imageDuration']").value;
        var transitionEffect = document.querySelector("[data-name='transitionEffect']").value;

        // Create a canvas element and set its dimensions
        var canvas = document.createElement("canvas");
        canvas.width = parseInt(resolution.split("x")[0]);
        canvas.height = parseInt(resolution.split("x")[1]);

        // Get the canvas context
        var context = canvas.getContext("2d");

        // Draw the video frame onto the canvas
        context.drawImage(myVideo, 0, 0, canvas.width, canvas.height);

        // Convert the canvas content to a data URL
        var dataURL = canvas.toDataURL("image/jpeg", quality);

        // Create a new video element with the captured frame and transition effect
        var newVideo = document.createElement("video");
        newVideo.src = dataURL;
        newVideo.controls = true;
        newVideo.setAttribute("duration", imageDuration);
        newVideo.setAttribute("data-transition", transitionEffect);

        // Replace the existing video with the new video
        myVideo.parentNode.replaceChild(newVideo, myVideo);

        // Remove dropdown menus after applying settings
        document.querySelectorAll(".output-dropdown").forEach(function(dropdown) {
            dropdown.remove();
        });
    }
</script>

</body>
</html>
